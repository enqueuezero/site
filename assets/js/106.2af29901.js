(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{492:function(t,e,a){"use strict";a.r(e);var s=a(54),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"timezone"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#timezone"}},[t._v("#")]),t._v(" Timezone")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#context"}},[t._v("Context")])]),a("li",[a("a",{attrs:{href:"#overview"}},[t._v("Overview")])]),a("li",[a("a",{attrs:{href:"#solutions"}},[t._v("Solutions")]),a("ul",[a("li",[a("a",{attrs:{href:"#the-system-timezone"}},[t._v("The System Timezone")])]),a("li",[a("a",{attrs:{href:"#programming-language-libraries"}},[t._v("Programming Language Libraries")])])])]),a("li",[a("a",{attrs:{href:"#patterns"}},[t._v("Patterns")]),a("ul",[a("li",[a("a",{attrs:{href:"#iana"}},[t._v("IANA")])]),a("li",[a("a",{attrs:{href:"#timedelta"}},[t._v("Timedelta")])]),a("li",[a("a",{attrs:{href:"#daylight-saving-time"}},[t._v("Daylight Saving Time")])]),a("li",[a("a",{attrs:{href:"#tz-time-format"}},[t._v("TZ time format")])]),a("li",[a("a",{attrs:{href:"#unix-timestamp"}},[t._v("Unix Timestamp")])])])]),a("li",[a("a",{attrs:{href:"#conclusion"}},[t._v("Conclusion")])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"context"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#context"}},[t._v("#")]),t._v(" Context")]),t._v(" "),a("p",[t._v("As the earth is a sphere, different places in the world will have different clocks. Human invented timezone to split the globe into 24 areas by regions. The UTC or Coordinated Universal Time is the primary time standard by which the world regulates clocks and time.")]),t._v(" "),a("p",[t._v("Programmers need to be aware of the timezone and what it means to the time they handle. In this case, the timezone libraries can help to ease the problem.")]),t._v(" "),a("h2",{attrs:{id:"overview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[t._v("#")]),t._v(" Overview")]),t._v(" "),a("h2",{attrs:{id:"solutions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#solutions"}},[t._v("#")]),t._v(" Solutions")]),t._v(" "),a("h3",{attrs:{id:"the-system-timezone"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-system-timezone"}},[t._v("#")]),t._v(" The System Timezone")]),t._v(" "),a("p",[t._v("The program needs to run in an OS, and thus system admin needs to set system timezone first. Almost every OS, such as Windows, macOS, Linux, Android, has an option to set the timezone.")]),t._v(" "),a("p",[t._v("Especially in POSIX, you can use command "),a("code",[t._v("tzselect")]),t._v(" to set the timezone and use environment variable "),a("code",[t._v("$TZ")]),t._v(" to get timezone. The "),a("code",[t._v("$TZ")]),t._v(" value is something like "),a("code",[t._v("America/New_York")]),t._v(", or "),a("code",[t._v("Pacific/Honolulu")]),t._v(". In the GNU C Library, the default time zone is like the specification "),a("code",[t._v("TZ=:/etc/localtime")]),t._v(" (or "),a("code",[t._v("TZ=:/usr/local/etc/localtime")]),t._v(", depending on how the GNU C Library was configured.")]),t._v(" "),a("p",[t._v("Check the manual of "),a("a",{attrs:{href:"https://www.gnu.org/software/libc/manual/html_node/TZ-Variable.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("TZ-Variable"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"programming-language-libraries"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#programming-language-libraries"}},[t._v("#")]),t._v(" Programming Language Libraries")]),t._v(" "),a("p",[t._v("Language libraries provide similar interfaces to convert time from local time to UTC or other local times in other regions.")]),t._v(" "),a("p",[t._v("The time objects can be categorized into timezone-aware and timezone-non-aware objects. A timezone-non-aware time object is usually referred to as local time in the programming context. Some might refer to UTC, while some might refer to local time.")]),t._v(" "),a("p",[t._v("Popular timezone libraries are listed below:")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://momentjs.com/timezone/docs/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Moment.js timezone"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://dateutil.readthedocs.io/en/stable/tz.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("python-dateutil tz"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("They have similar API form:")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("tzaware_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" IANA_KEY"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nutc_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" to_utc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tzaware_time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"patterns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#patterns"}},[t._v("#")]),t._v(" Patterns")]),t._v(" "),a("h3",{attrs:{id:"iana"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#iana"}},[t._v("#")]),t._v(" IANA")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.iana.org/time-zones",target:"_blank",rel:"noopener noreferrer"}},[t._v("IANA TZ database"),a("OutboundLink")],1),t._v(" contains code and data that represent the history of local time for many representative locations around the globe. It is updated periodically.")]),t._v(" "),a("p",[t._v("We need this database because the timezone is not a fixed data. Governments or local policymakers might change the timezone for a region for some reason. For example, the Samoa government changed the timezone from UTC-11 to UTC+13 (daylight saving time from UTC-10 to UTC+14) since 29 Dec 2011.")]),t._v(" "),a("p",[t._v("You can find a list of timezones in a POSIX-like system like below:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" /usr/share/zoneinfo\n+VERSION    CET         Eire        GMT0        Japan       Navajo      Turkey      posixrules\nAfrica      CST6CDT     Etc         Greenwich   Kwajalein   PRC         UCT         zone.tab\nAmerica     Canada      Europe      HST         Libya       PST8PDT     US\nAntarctica  Chile       Factory     Hongkong    MET         Pacific     UTC\nArctic      Cuba        GB          Iceland     MST         Poland      Universal\nAsia        EET         GB-Eire     Indian      MST7MDT     Portugal    W-SU\nAtlantic    EST         GMT         Iran        Mexico      ROC         WET\nAustralia   EST5EDT     GMT+0       Israel      NZ          ROK         Zulu\nBrazil      Egypt       GMT-0       Jamaica     NZ-CHAT     Singapore   iso3166.tab\n")])])]),a("p",[t._v("Usually, you can get a TZ object by giving an IANA TZ database key. For example, in Python-dateutil, you can get TZ by "),a("code",[t._v("gettz")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" gettz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Pacific/Kiritimati'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntzfile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/usr/share/zoneinfo/Pacific/Kiritimati'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" datetime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("now"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tzutc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndatetime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("datetime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2018")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("43")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("293800")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tzinfo"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tzutc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"timedelta"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#timedelta"}},[t._v("#")]),t._v(" Timedelta")]),t._v(" "),a("p",[t._v("Under the hood, the timezone calculation is merely to add or minus a few hours to the given time based on the timezone setting.")]),t._v(" "),a("p",[t._v('For example, for TZ "Asia/Shanghai" you can get a UTC time first, and then apply it to the local TZ for local time:')]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" datetime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("utcnow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" timedelta"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hours"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"daylight-saving-time"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#daylight-saving-time"}},[t._v("#")]),t._v(" Daylight Saving Time")]),t._v(" "),a("p",[t._v("DST or daylight saving time, sometimes also referred to as summer time in some countries, is a practice of advancing clocks during summer months, so that evening daylight lasts longer. It also means this practice makes timezone a little bit complicated.")]),t._v(" "),a("p",[t._v("You can't merely apply time to "),a("code",[t._v("+timedelta(hours=12)")]),t._v(" for Pacific/Auckland timezone. In summer time, you have to apply time to "),a("code",[t._v("+timedelta(hours=13)")]),t._v(".")]),t._v(" "),a("p",[t._v("Fortunately, the programming language tz libraries would generally handle that for you. All the thing you need to do is to get a timezone by IANA key instead of adding timedelta by yourself.")]),t._v(" "),a("h3",{attrs:{id:"tz-time-format"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tz-time-format"}},[t._v("#")]),t._v(" TZ time format")]),t._v(" "),a("p",[t._v("When people format datetime with timezone into string, ISO8601 might be a good solution. For example, the given time might be in below format:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v('"2008-09-15T15:53:00+05:00"')])]),t._v(" "),a("li",[a("code",[t._v('"2008-09-15T15:53:00+0500"')])]),t._v(" "),a("li",[a("code",[t._v('"2008-09-15T15:53:00+05"')])]),t._v(" "),a("li",[a("code",[t._v('"2008-09-15T10:53:00Z"')])])]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("Z")]),t._v(" here means UTC.")]),t._v(" "),a("h3",{attrs:{id:"unix-timestamp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#unix-timestamp"}},[t._v("#")]),t._v(" Unix Timestamp")]),t._v(" "),a("p",[t._v("When converting in between timezone and datetime, you need to be aware of the relationship between each other. For example, in Python, you can convert a timestamp into utc time tuple or local time tuple.")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" time\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# timestamp to time tuple in UTC")]),t._v("\ntimestamp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1226527167.595983")]),t._v("\nutc_time_tuple "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gmtime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("repr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("utc_time_tuple"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# timestamp to time tuple in local time")]),t._v("\ntimestamp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1226527167.595983")]),t._v("\nlocal_time_tuple "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("localtime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("repr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("local_time_tuple"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("Check "),a("a",{attrs:{href:"https://www.saltycrane.com/blog/2008/11/python-datetime-time-conversions/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Python datetime / time conversions"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"conclusion"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[t._v("#")]),t._v(" Conclusion")]),t._v(" "),a("p",[t._v("Someone believes the time is the essence of the programming, and in this way it is.")]),t._v(" "),a("p",[t._v("When handling the time, don't forget to check the system settings. In programming, choosing a good library can save you time.")]),t._v(" "),a("p",[t._v("It's a good practice to store time in UTC as timezone into the database all the time. You might want to convert them into timezone-aware objects only when you need to handle user requests or display them.")])])}),[],!1,null,null,null);e.default=n.exports}}]);