(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{443:function(e,t,a){"use strict";a.r(t);var s=a(54),i=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"time-series"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#time-series"}},[e._v("#")]),e._v(" Time Series")]),e._v(" "),a("h2",{attrs:{id:"context"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#context"}},[e._v("#")]),e._v(" Context")]),e._v(" "),a("p",[e._v("A system is meant to run continuously and thus creates flowing data over time. In term of metrics, the system reports discrete data points each moment. It's a challenge to structure, store, and analyze these data points.")]),e._v(" "),a("h2",{attrs:{id:"overview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),a("p",[e._v("A time series is a series of data points indexed (or listed or graphed) in time order.\nEach data point is often a numeric value.\nEach time series consists of a name plus optional tags.")]),e._v(" "),a("p",[e._v("For example, A Linux system expose its load data by reading from "),a("code",[e._v("/proc/loadavg")]),e._v(". Then we could have such a metric that has "),a("code",[e._v("proc.loadavg.1m")]),e._v(" as metric name, "),a("code",[e._v("host=web-1.svc.prod.example.com")]),e._v(" as tag, "),a("code",[e._v("0.03")]),e._v(" as data point value. The time series is a sequence of floating value like "),a("code",[e._v("0.03")]),e._v(" that reflects system load over time.")]),e._v(" "),a("h2",{attrs:{id:"solutions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#solutions"}},[e._v("#")]),e._v(" Solutions")]),e._v(" "),a("h3",{attrs:{id:"prometheus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prometheus"}},[e._v("#")]),e._v(" Prometheus")]),e._v(" "),a("p",[e._v("Prometheus is a time series database and fundamentally stores all data as time series: streams of timestamped values belonging to the same metric and the same set of labeled dimensions.")]),e._v(" "),a("p",[e._v("Every time series is uniquely identified by its metric name and a set of key-value pairs, also known as labels. The metric name specifies the general feature of a system that is measured.")]),e._v(" "),a("p",[e._v("Samples form the actual time series data.Each sample consists of a timestamp and a float value.")]),e._v(" "),a("p",[e._v("Below is how a typical prometheus metric looks like:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('response_time{method="GET", domain="enqueuezero.com", path="/"} 0.021\n')])])]),a("p",[e._v("It's a sample of a time series data with "),a("code",[e._v("response_time")]),e._v(" as metric name, "),a("code",[e._v('method="GET", domain="enqueuezero.com", path="/"')]),e._v(" as labels, "),a("code",[e._v("0.021")]),e._v(" as sample value. Notably, Prometheus uses current UNIX timestamp as sample's timestamp.")]),e._v(" "),a("h3",{attrs:{id:"graphite"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#graphite"}},[e._v("#")]),e._v(" Graphite")]),e._v(" "),a("p",[e._v("Graphite is a monitoring tool  Time series plays a critical role in the system design.")]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("Carbon")]),e._v(": a high-performance service that listens for time-series data.")]),e._v(" "),a("li",[a("strong",[e._v("Whisper")]),e._v(": a simple database library for storing time-series data.")]),e._v(" "),a("li",[a("strong",[e._v("graphite-web")]),e._v(": Graphite's user interface & API for rendering graphs and dashboards.")])]),e._v(" "),a("p",[e._v("In particular, the form of time series data in Graphite  There is no labels in Graphite comparing to Prometheus, making metric names being the only way to store both concepts "),a("code",[e._v("metric name")]),e._v(" and "),a("code",[e._v("labels")]),e._v(" in Prometheus. It has below form:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("response_time.enqueuezero_com.GET.index 0.21\n")])])]),a("h3",{attrs:{id:"influxdb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#influxdb"}},[e._v("#")]),e._v(" InfluxDB")]),e._v(" "),a("p",[e._v("InfluxDB is yet another time series database. It has a unique kind of database indexing file format called time series index (TSI) that stores time series data efficiently, which we'll explain later.")]),e._v(" "),a("p",[e._v("InfluxDB time series data consists of below fields: "),a("code",[e._v("measurement")]),e._v(", "),a("code",[e._v("fields")]),e._v(", "),a("code",[e._v("tags")]),e._v(", "),a("code",[e._v("time")]),e._v(".")]),e._v(" "),a("ul",[a("li",[e._v("The measurement acts as a container for tags, fields, and the time column, and the measurement name is the description of the data that are stored in the associated fields.")]),e._v(" "),a("li",[e._v("Tags are key-value pairs. Together with measurement, they make a metric unique. From this point of view, measurement and tags are equivalent to Prometheus metric name and labels.")]),e._v(" "),a("li",[e._v("Fields are key-value pairs. InfluxDB support ingest multiple fields into a sample.")]),e._v(" "),a("li",[e._v("Time stores timestamps, and the timestamp shows the date and time, in RFC3339 UTC, associated with particular data.")])]),e._v(" "),a("p",[e._v("It has below form in line protocol:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('access,method="GET",domain="enqueuezero.com",path="/" response_time=0.21\n')])])]),a("p",[e._v("It also support represent and interact data in JSON format:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('{\n    "measurement": "access",\n    "tags": {\n        "method": "GET",\n        "domain": "enqueuezero.com",\n        "path": "/"\n    },\n    "fields": {\n        "response_time": 0.21\n    }\n}\n')])])]),a("h3",{attrs:{id:"wavefront"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wavefront"}},[e._v("#")]),e._v(" Wavefront")]),e._v(" "),a("p",[e._v("Wavefront is a monitoring analytics platform. One of its fundamental concept is also time series. In particular, it has below data format syntax:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<metricName> <metricValue> [<timestamp>] source=<source> [pointTags]\n")])])]),a("ul",[a("li",[e._v("metricName is the name of the metric. It organize metrics in a meaningful hierarchy by separating levels by "),a("code",[e._v(".")]),e._v(". For example, "),a("code",[e._v("system.cpu0.loadavg.1m")]),e._v(".")]),e._v(" "),a("li",[e._v("metricValue is the value of the metric. It can be double-precision floating point number or a long integer.")]),e._v(" "),a("li",[e._v("timestamp reflects the epoch seconds of the metric.")]),e._v(" "),a("li",[e._v("source indicates where the data is from. It can be the name of an application, host, container, instance or any other unique sources.")]),e._v(" "),a("li",[e._v("pointTags are key-value pairs.")])]),e._v(" "),a("p",[e._v("Below example shows how it looks like:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('access.response_time 0.21 15029382000 source=web-1.svc.local method="GET" domain="enqueuezero.com" path="/"\n')])])]),a("h3",{attrs:{id:"opentsdb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#opentsdb"}},[e._v("#")]),e._v(" OpenTSDB")]),e._v(" "),a("p",[e._v("OpenTSDB is yet another time series database. A typical time series data point that send to OpenTSDB is like below.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("put access.response_time 15029382000 0.21 host=web-1.svc.local method=GET domain=enqueuezero.com path=index\n")])])]),a("h2",{attrs:{id:"patterns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#patterns"}},[e._v("#")]),e._v(" Patterns")]),e._v(" "),a("h3",{attrs:{id:"data-storing"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-storing"}},[e._v("#")]),e._v(" Data Storing")]),e._v(" "),a("p",[e._v("It's a challenge on storing time series data. Below is a list of notable things.")]),e._v(" "),a("ul",[a("li",[e._v("Deduplicate. A sample data may be sent multiple times. How to store exact the same data when a client sends time series several times?")]),e._v(" "),a("li",[e._v("Few deletions. Delete operation is a rare occurrence. When people delete time series, it's often not just to delete a few sample to but purge data among a large time of periods.")]),e._v(" "),a("li",[e._v("Updates happens. A sample data may be sent multiple times with different fields or values. How to overwrite these data?")]),e._v(" "),a("li",[e._v("Time affiliated. Each sample associates with a timestamp and is ingested in time ascending order.")])]),e._v(" "),a("h3",{attrs:{id:"data-types"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-types"}},[e._v("#")]),e._v(" Data Types")]),e._v(" "),a("p",[e._v("Almost every time series database can support numeric numbers. A few of them can support boolean, string, etc.")]),e._v(" "),a("p",[e._v("The timestamp is usually a long integer with second-precision, millisecond-precision, or even nanosecond-precision.")]),e._v(" "),a("p",[e._v("As for the metric types, below are the most common seen types.")]),e._v(" "),a("ul",[a("li",[e._v("A "),a("strong",[e._v("counter")]),e._v(" is a cumulative metric that represents a single monotonically increasing counter whose value can only increase or be reset to zero on restart.")]),e._v(" "),a("li",[e._v("A "),a("strong",[e._v("gauge")]),e._v(" is a metric that represents a single numerical value that can arbitrarily go up and down.")]),e._v(" "),a("li",[e._v("A "),a("strong",[e._v("histogram")]),e._v(" is a bucketed metric that counts values in a configurable bucket.")])]),e._v(" "),a("h3",{attrs:{id:"data-analytics"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-analytics"}},[e._v("#")]),e._v(" Data Analytics")]),e._v(" "),a("p",[e._v("The analytics based on time series data is about to dig out the trend or patterns revealed from the changes of values.\nCommon analytic method is through statistical analysis, for example, percentage, percentile, etc.\nAnother approach is by using machine learning and deep learning.\nStatistical analysis is the first choice. Even by using machine learning or deep learning, it's also recommended to combine with statistical analysis.")]),e._v(" "),a("h4",{attrs:{id:"filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#filters"}},[e._v("#")]),e._v(" Filters")]),e._v(" "),a("p",[e._v("When querying time sereis data, it's always good to filter data so that only a limit set of data points are returned.\nThis could protect the time series database query engine.")]),e._v(" "),a("p",[e._v("One effective approach is to align data points. Instead of write all data points, we can align data points to buckets in configured time windows.\nFor example, we collect five data points but only save the average of the five data points into database.")]),e._v(" "),a("p",[e._v("Another approach is to downsample data points when querying. We can take a sample of data points every a few minutes.\nFor example, we save five data points over five minutes but only fetch one data point over five minutes.")]),e._v(" "),a("h2",{attrs:{id:"references"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#references"}},[e._v("#")]),e._v(" References")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Time_series",target:"_blank",rel:"noopener noreferrer"}},[e._v("Wikipedia"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://prometheus.io/docs/concepts/data_model/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Prometheus Data Model"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://graphiteapp.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Graphite"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://docs.influxdata.com/influxdb/v1.7/concepts/key_concepts/",target:"_blank",rel:"noopener noreferrer"}},[e._v("InfluxDB key concepts"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://docs.wavefront.com/wavefront_data_format.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Wavefront Data Format"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=i.exports}}]);