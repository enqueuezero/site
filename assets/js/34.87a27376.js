(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{421:function(e,t,s){"use strict";s.r(t);var r=s(54),o=Object(r.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"kubernetes-in-a-nutshell"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-in-a-nutshell"}},[e._v("#")]),e._v(" Kubernetes In a Nutshell")]),e._v(" "),s("p",[s("strong",[e._v("Kubernetes")]),e._v(" is a system for running and coordinating containerized applications.")]),e._v(" "),s("p",[e._v("These applications are deployed across a cluster of machines.")]),e._v(" "),s("p",[e._v("As a Kubernetes user, you define how the application should run.")]),e._v(" "),s("p",[e._v("You also define how the application should interact with other applications or the outside world.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("Kubernetes brings together machine servers into a cluster using a shared network.")]),e._v(" "),s("p",[s("strong",[e._v("Master")]),e._v(" server(s) controls the entire cluster.")]),e._v(" "),s("p",[s("strong",[e._v("Nodes")]),e._v(" are the other servers in the cluster.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("As a Kubernetes user, you might most want to ask Kubernetes to "),s("strong",[e._v("run a container")]),e._v(" via HTTP APIs or CLI.")]),e._v(" "),s("p",[e._v("In other words, you set a desired state to the "),s("strong",[e._v("Master")]),e._v(" server.")]),e._v(" "),s("p",[e._v("The "),s("strong",[e._v("Master")]),e._v(" server compares the desired state to the current state in the cluster and decides which node to run.")]),e._v(" "),s("p",[s("strong",[e._v("Node")]),e._v(" servers receive instructions from the "),s("strong",[e._v("Master")]),e._v(" server and then starts a container in the runtime.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("Kubernetes runs applications and services in "),s("strong",[e._v("container runtime")]),e._v(" on every node.")]),e._v(" "),s("p",[e._v("Each node installs with a "),s("strong",[e._v("container runtime")]),e._v(", such as "),s("code",[e._v("docker")]),e._v(", "),s("code",[e._v("rkt")]),e._v(".")]),e._v(" "),s("p",[e._v("The "),s("strong",[e._v("container runtime")]),e._v(" is responsible for starting and managing containers.")]),e._v(" "),s("p",[e._v("The "),s("strong",[e._v("container")]),e._v(" provides an isolated environment for running the application.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("Except the container runtime, the "),s("strong",[e._v("Node")]),e._v(" server runs "),s("strong",[e._v("kubelet")]),e._v(" and "),s("strong",[e._v("kube-proxy")]),e._v(".")]),e._v(" "),s("p",[s("strong",[e._v("Kubelet")]),e._v(" communicates to the "),s("strong",[e._v("master")]),e._v(" to receive desired states.")]),e._v(" "),s("p",[s("strong",[e._v("Kubelet")]),e._v(" controls the "),s("strong",[e._v("container runtime")]),e._v(" to launch or destroy containers to match the desired states.")]),e._v(" "),s("p",[s("strong",[e._v("Kube-proxy")]),e._v(" forwards requests to the containers, either in localhost or other hosts.")]),e._v(" "),s("p",[e._v("As a Kubernetes user, you don't necessarily need to know the existence of "),s("strong",[e._v("kubelet")]),e._v(" and "),s("strong",[e._v("kube-proxy")]),e._v(".")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("A "),s("strong",[e._v("Pod")]),e._v(" is one or more containers in a group that should always run on the same "),s("strong",[e._v("node")]),e._v(".")]),e._v(" "),s("p",[e._v("All containers in a "),s("strong",[e._v("pod")]),e._v(" are launched and destroyed together, or share a life cycle.")]),e._v(" "),s("p",[e._v("All containers in a "),s("strong",[e._v("pod")]),e._v(" share their environments, volumes, and IP space.")]),e._v(" "),s("p",[e._v("Usually, there is one main container and some optional "),s("strong",[e._v("sidecar containers")]),e._v(" in a "),s("strong",[e._v("pod")]),e._v(".")]),e._v(" "),s("p",[e._v("As a Kubernetes user, you can show all pods in the cluster by typing "),s("code",[e._v("kubectl get pods")]),e._v(".")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("A "),s("strong",[e._v("ReplicaSet")]),e._v(" is one or more pod replicas that are running at any given time.")]),e._v(" "),s("p",[e._v("The "),s("strong",[e._v("replica")]),e._v(" number in the "),s("strong",[e._v("ReplicaSet")]),e._v(" defines how many identical pods should be scheduled in the cluster.")]),e._v(" "),s("p",[e._v("If the "),s("strong",[e._v("replica")]),e._v(" number changes, the controller will start or destroy containers to match the desired number.")]),e._v(" "),s("p",[e._v("If a "),s("strong",[e._v("pod")]),e._v(" or underlying "),s("strong",[e._v("node")]),e._v(" dies, the controller will start a new "),s("strong",[e._v("pod")]),e._v(" in the cluster.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("A "),s("strong",[e._v("Deployment")]),e._v(" is a desired state for "),s("strong",[e._v("ReplicaSets")]),e._v(".")]),e._v(" "),s("p",[e._v("The "),s("strong",[e._v("deployment controller")]),e._v(" creates new replicasets for the rolling updates and then replaces the current replicaset.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("For database applications, we cannot directly kill pods in random order.")]),e._v(" "),s("p",[e._v("Instead, we often kill all slaves and let the master die at last.")]),e._v(" "),s("p",[e._v("To support the ordering and uniqueness of Pods, Kubernetes offers "),s("strong",[e._v("StatefulSet")]),e._v(".")]),e._v(" "),s("p",[e._v("It creates a set of pods in the name like "),s("code",[e._v("db-0")]),e._v(", "),s("code",[e._v("db-1")]),e._v(", "),s("code",[e._v("db-2")]),e._v(", etc.")]),e._v(" "),s("p",[e._v("It provides guarantees about the ordering and uniqueness of these Pods.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("For applications like logging agents, we want to deploy them per host.")]),e._v(" "),s("p",[e._v("To support such feature, Kubernetes offers "),s("strong",[e._v("DaemonSet")]),e._v(".")]),e._v(" "),s("p",[e._v("It ensures that all (or some) Nodes run a copy of a Pod.")]),e._v(" "),s("p",[e._v("As nodes are added to the cluster, Pods are added to them.")]),e._v(" "),s("p",[e._v("As nodes are removed from the cluster, those Pods are garbage collected.")]),e._v(" "),s("p",[e._v("Deleting a DaemonSet will clean up the Pods it created.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("Some Kubernetes objects are owners of other objects.")]),e._v(" "),s("p",[e._v("For example, a ReplicaSet is the owner of a set of Pods.")]),e._v(" "),s("p",[e._v("When the owner is deleted, the owned objects are garbage collected as well.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("In case you have one-off jobs, Kubernetes offers "),s("strong",[e._v("Jobs")]),e._v(".")]),e._v(" "),s("p",[e._v("A "),s("strong",[e._v("job")]),e._v(" creates one or more pods and ensures that a specified number of them successfully terminate.")]),e._v(" "),s("p",[e._v("When a specified number of successful completion is reached, the job itself is complete.")]),e._v(" "),s("p",[e._v("Deleting a Job will clean up the pods it created.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("What if one pod wants to communicate to other pods? Kubernetes offers "),s("strong",[e._v("Services")]),e._v(".")]),e._v(" "),s("p",[e._v("A "),s("strong",[e._v("Service")]),e._v(" is a component that acts as a basic internal load balancer for pods.")]),e._v(" "),s("p",[e._v("The "),s("strong",[e._v("Service")]),e._v(" exposes a group of pods as a single entity. When one pod communicates to a service, the service proxies the request to one of the backend pods.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("A "),s("strong",[e._v("Service")]),e._v(" has a DNS A record.")]),e._v(" "),s("p",[e._v("For example, "),s("strong",[e._v("Service")]),e._v(' "foo" in namespace "default" has such domain: "foo.default.svc.cluster.local".')]),e._v(" "),s("p",[e._v("A "),s("strong",[e._v("Pod")]),e._v(" has a DNS A record as well.")]),e._v(" "),s("p",[e._v("For example, "),s("strong",[e._v("Pod")]),e._v(" with IP "),s("code",[e._v("10.81.1.101")]),e._v(' in the namespace "default" has such domain: "10-81-1-101.default.pod.cluster.local".')]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("What if one service wants to expose itself to the external world? Kubernetes offers "),s("strong",[e._v("Ingress")]),e._v(".")]),e._v(" "),s("p",[s("strong",[e._v("Ingress")]),e._v(" exposes HTTP and HTTPS routes from outside the cluster to services within the cluster.")]),e._v(" "),s("p",[s("strong",[e._v("Ingress controller")]),e._v(" starts "),s("strong",[e._v("Ingress")]),e._v(" software, such as Nginx, F5, HAProxy, etc.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("If the container dies or the node crashes, all files in the containers are gone.")]),e._v(" "),s("p",[e._v("To keep the data, Kubernetes provides "),s("strong",[e._v("Volumes")]),e._v(" for persisting on-disk files.")]),e._v(" "),s("p",[e._v("A "),s("strong",[e._v("Volume")]),e._v(" is just a directory, possibly with some data in it, which is accessible to the Containers in a Pod.")]),e._v(" "),s("p",[e._v("When the container gets restarted, the "),s("strong",[e._v("volume")]),e._v(" is re-mounted into the container, and thus all data are recovered.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("A "),s("strong",[e._v("PersistentVolume")]),e._v(" is a piece of storage in the cluster that has been pre-provisioned.")]),e._v(" "),s("p",[e._v("The "),s("strong",[e._v("PersistentVolume")]),e._v(" is a resource in the cluster just like a node is a cluster resource.")]),e._v(" "),s("p",[e._v("Often "),s("strong",[e._v("PersistentVolume")]),e._v(" uses cloud storage system like AWS EBS, Azure  Disk, GCE PD, etc.")]),e._v(" "),s("p",[e._v("The "),s("strong",[e._v("PersistentVolume")]),e._v(" makes the volume out of Pod life-cycle.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("A "),s("strong",[e._v("PersistentVolumeClaim")]),e._v(" is a request for "),s("strong",[e._v("PersistentVolume")]),e._v(".")]),e._v(" "),s("p",[e._v("Once a pod is done with a "),s("strong",[e._v("PersistentVolume")]),e._v(", the claim policy determines if the existing volume should be kept or removed.")]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("Kubernetes is a complicated system that has dozens of concepts.")]),e._v(" "),s("p",[e._v("The official document provides a complete guide to the concepts. "),s("a",{attrs:{href:"https://kubernetes.io/docs/concepts/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://kubernetes.io/docs/concepts/"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("Other resources that kill less your brain cells.")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://thenewstack.io/kubernetes-gets-childrens-book/",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"/static/images/kubernetes-in-a-nutshell-illustrated-guide-illustration-12.png",alt:"Kubernetes Gets a Children’s Book"}}),s("OutboundLink")],1),e._v(" "),s("a",{attrs:{href:"https://thenewstack.io/kubernetes-gets-childrens-book/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kubernetes Gets a Children's Book"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("a",{attrs:{href:"https://cloud.google.com/kubernetes-engine/kubernetes-comic/",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"/static/images/kubernetes-in-a-nutshell-smooth-sailing-with-k8s.png",alt:"Smooth Sailing with K8S"}}),s("OutboundLink")],1),e._v(" "),s("a",{attrs:{href:"https://cloud.google.com/kubernetes-engine/kubernetes-comic/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Smooth Sailing with k8s"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("a",{attrs:{href:"https://www.mgasch.com/post/k8sevents/",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"/static/images/readings-2018-51-k8s-api-server-queues.png",alt:"kubernetes api server as event queue"}}),s("OutboundLink")],1),e._v(" "),s("a",{attrs:{href:"https://www.mgasch.com/post/k8sevents/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Events, the DNA of Kubernetes"),s("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=o.exports}}]);