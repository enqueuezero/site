(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{402:function(e,r,a){"use strict";a.r(r);var t=a(54),i=Object(t.a)({},(function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"airbnb-architecture"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#airbnb-architecture"}},[e._v("#")]),e._v(" Airbnb Architecture")]),e._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#overview"}},[e._v("Overview")])]),a("li",[a("a",{attrs:{href:"#solutions"}},[e._v("Solutions")]),a("ul",[a("li",[a("a",{attrs:{href:"#aws-stack"}},[e._v("AWS Stack")])]),a("li",[a("a",{attrs:{href:"#load-balancer"}},[e._v("Load Balancer")])]),a("li",[a("a",{attrs:{href:"#service-discovery"}},[e._v("Service Discovery")])])])]),a("li",[a("a",{attrs:{href:"#web-tier"}},[e._v("Web Tier")])]),a("li",[a("a",{attrs:{href:"#data-tier"}},[e._v("Data Tier")]),a("ul",[a("li",[a("a",{attrs:{href:"#infrastructure-as-code"}},[e._v("Infrastructure as code")])]),a("li",[a("a",{attrs:{href:"#data-warehouse"}},[e._v("Data Warehouse")])]),a("li",[a("a",{attrs:{href:"#microservices"}},[e._v("Microservices")])]),a("li",[a("a",{attrs:{href:"#search-service"}},[e._v("Search Service")])])])]),a("li",[a("a",{attrs:{href:"#references"}},[e._v("References")])])])]),a("p"),e._v(" "),a("h2",{attrs:{id:"overview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),a("p",[e._v("Airbnb is a website that operates an online marketplace and hospitality service for people to lease or rent short-term lodging. The challenges for the engineering team includes high-availability, quick-scaling, etc. In this post, I put the architecture of Airbnb website in one article. Please tweet to "),a("a",{attrs:{href:"https://twitter.com/enqueuezero",target:"_blank",rel:"noopener noreferrer"}},[e._v("@enqueuezero"),a("OutboundLink")],1),e._v(" if you think anything is incorrect or out-dated.")]),e._v(" "),a("p",[e._v("Disclaimer: I'm not from Airbnb team and don't know anybody from Airbnb. All information can be found on the Internet, mainly from "),a("a",{attrs:{href:"https://medium.com/airbnb-engineering",target:"_blank",rel:"noopener noreferrer"}},[e._v("the Airbnb engineering blog"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"solutions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#solutions"}},[e._v("#")]),e._v(" Solutions")]),e._v(" "),a("h3",{attrs:{id:"aws-stack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#aws-stack"}},[e._v("#")]),e._v(" AWS Stack")]),e._v(" "),a("p",[e._v("Airbnb uses below AWS services.")]),e._v(" "),a("ul",[a("li",[e._v("It uses EC2 instances for its application, memcache, and search servers.")]),e._v(" "),a("li",[e._v("It uses RDS as main MySQL database.")]),e._v(" "),a("li",[e._v("It used ELB for traffic load balancing (Note: seems no longer used anymore, check section "),a("code",[e._v("Load Balancer")]),e._v(" below.).")]),e._v(" "),a("li",[e._v("It uses EMR for daily data processing and analyzing (Note: seems somewhat out-dated, check section "),a("code",[e._v("Data Warehouse")]),e._v(" below).")]),e._v(" "),a("li",[e._v("It uses S3 for backups and static files, including user pictures.")]),e._v(" "),a("li",[e._v("It uses Amazon CloudWatch to supervise ES2 assets.")])]),e._v(" "),a("h3",{attrs:{id:"load-balancer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#load-balancer"}},[e._v("#")]),e._v(" Load Balancer")]),e._v(" "),a("p",[e._v("Charon is Airbnb's front-facing load balancer. Previously it was Amazon's ELB. The decision based on the fact that ELB was clunky and less helpful to troubleshoot.")]),e._v(" "),a("p",[e._v("With Charon, Akamai traffic hits Nginx servers directly. Then the traffic routes to the backend services by Synapse and HAProxy.")]),e._v(" "),a("h3",{attrs:{id:"service-discovery"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service-discovery"}},[e._v("#")]),e._v(" Service Discovery")]),e._v(" "),a("ul",[a("li",[e._v("SmartStack is an OSS service discovery framework. It has two components: "),a("a",{attrs:{href:"https://github.com/airbnb/nerve",target:"_blank",rel:"noopener noreferrer"}},[e._v("Nerve"),a("OutboundLink")],1),e._v(" and "),a("a",{attrs:{href:"https://github.com/airbnb/synapse",target:"_blank",rel:"noopener noreferrer"}},[e._v("Synapse"),a("OutboundLink")],1),e._v(". It relies on Zookeeper to store discovery data, as well as HAProxy for routing.")]),e._v(" "),a("li",[e._v("Nerve manages the life-cycle of microservices based on health checks.")]),e._v(" "),a("li",[e._v("Synapse looks up microservices instances and automatically update HAProxy configuration.")]),e._v(" "),a("li",[e._v("Zookeeper stores znode for the name of the services and provide microservice instances change via Zookeeper watches.")])]),e._v(" "),a("h2",{attrs:{id:"web-tier"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-tier"}},[e._v("#")]),e._v(" Web Tier")]),e._v(" "),a("p",[e._v("Airbnb users Rails for the front-end.")]),e._v(" "),a("h2",{attrs:{id:"data-tier"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-tier"}},[e._v("#")]),e._v(" Data Tier")]),e._v(" "),a("p",[e._v("Airbnb uses Amazon RDS as main MySQL database. The databases are deployed in multi-AZ (availability zone). Below 3-tier architecture reflects the basic pattern. Note that there are several types of databases for different scenarios, for example, "),a("code",[e._v("airmaster")]),e._v(", "),a("code",[e._v("calendar")]),e._v(", "),a("code",[e._v("message")]),e._v(", etc. Therefore, there are over a dozen dbproxy and hundreds of database instances gets deployed.")]),e._v(" "),a("p",[a("img",{attrs:{src:"/static/images/airbnb-architecture-3-tier-db.png",alt:"3 Tier DB"}})]),e._v(" "),a("ul",[a("li",[e._v("They're the community edition of MySQL server.")]),e._v(" "),a("li",[e._v("Each MySQL server uses one-thread-per-connection model.")]),e._v(" "),a("li",[e._v("Airbnb "),a("a",{attrs:{href:"https://github.com/airbnb/MaxScale",target:"_blank",rel:"noopener noreferrer"}},[e._v("forked and modified"),a("OutboundLink")],1),e._v(" MariaDB MaxScale for database proxy.")]),e._v(" "),a("li",[e._v("Main functionalities of this proxy layer include connection pooling, request throttling, query blocklist, etc.")])]),e._v(" "),a("h3",{attrs:{id:"infrastructure-as-code"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#infrastructure-as-code"}},[e._v("#")]),e._v(" Infrastructure as code")]),e._v(" "),a("p",[e._v("Airbnb manages infrastructure with "),a("a",{attrs:{href:"https://www.chef.io/chef/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Chef"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"data-warehouse"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-warehouse"}},[e._v("#")]),e._v(" Data Warehouse")]),e._v(" "),a("p",[e._v("The Airbnb data infrastructure handles metrics, trains machine learning models, and runs business analytics, etc.")]),e._v(" "),a("p",[a("img",{attrs:{src:"/static/images/airbnb-architecture-data-pipeline.png",alt:"Data Pipeline"}})]),e._v(" "),a("ul",[a("li",[e._v("Kafka performs as a broker for event logs.")]),e._v(" "),a("li",[e._v("Sqoop performs as a broker for production database dumps.")]),e._v(" "),a("li",[e._v("The Gold and Silver Hive cluster are the data sinks. The Gold Hive cluster replicates data to silver. The Gold Hive cluster has a higher SLA guarantee.")]),e._v(" "),a("li",[e._v("A Spark Cluster works on machine learning for stream processing.")]),e._v(" "),a("li",[e._v("A Presto Cluster is for ad hoc querying.")]),e._v(" "),a("li",[e._v("An Airflow application runs in front-end for job scheduling.")]),e._v(" "),a("li",[e._v("S3 is a long-term solution for HDFS data.")])]),e._v(" "),a("h3",{attrs:{id:"microservices"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#microservices"}},[e._v("#")]),e._v(" Microservices")]),e._v(" "),a("p",[e._v("Airbnb uses "),a("a",{attrs:{href:"https://www.dropwizard.io/1.3.5/docs/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Dropwizard"),a("OutboundLink")],1),e._v(" service framework, and customized a Thrift service IDL.")]),e._v(" "),a("ul",[a("li",[e._v("Developers can choose between JSON-over-http and Thrift-over-http.")]),e._v(" "),a("li",[e._v("Downstream services need to install generated RPC clients from upstream.")]),e._v(" "),a("li",[e._v("Downstream services also need to apply standard timeout, retry, and circuit breaker logic.")]),e._v(" "),a("li",[e._v("The framework adds request and response metrics on both service-side and client-side.")]),e._v(" "),a("li",[e._v("The framework adds requests context, including request id to all underlying service requests.")]),e._v(" "),a("li",[e._v("The framework supports adding alerts based on metrics like "),a("code",[e._v("p95_latency")]),e._v(", "),a("code",[e._v("p99_latency")]),e._v(", etc.")])]),e._v(" "),a("h3",{attrs:{id:"search-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#search-service"}},[e._v("#")]),e._v(" Search Service")]),e._v(" "),a("p",[a("img",{attrs:{src:"/static/images/airbnb-architecture-search.png",alt:"Search Service"}})]),e._v(" "),a("ul",[a("li",[e._v("Nebula is a schema-less, versioned data store service with both real-time random data access and offline batch data management.")]),e._v(" "),a("li",[e._v("The search flow only adds some search indexing logic into this system.")]),e._v(" "),a("li",[e._v("The snapshot is generated daily as a part of the offline data merge.")]),e._v(" "),a("li",[e._v("The search index is built from the snapshot and then deployed to search periodically as an ordinary binary deploy.")])]),e._v(" "),a("h2",{attrs:{id:"references"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#references"}},[e._v("#")]),e._v(" References")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/data-infrastructure-at-airbnb-8adfb34f169c",target:"_blank",rel:"noopener noreferrer"}},[e._v("Data Infrastructure at Airbnb"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/https-medium-com-jonathan-parks-scaling-erf-23fd17c91166",target:"_blank",rel:"noopener noreferrer"}},[e._v("Scaling Airbnb's Experimentation Platform"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://www.quora.com/What-is-the-AirBNB-Software-Architecture",target:"_blank",rel:"noopener noreferrer"}},[e._v("What is the Airbnb Software Architecture"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://aws.amazon.com/solutions/case-studies/airbnb/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Airbnb Case Study"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/binaryalert-real-time-serverless-malware-detection-ca44370c1b90",target:"_blank",rel:"noopener noreferrer"}},[e._v("BinaryAlert: Real-time Serverless Malware Detection"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/alerting-framework-at-airbnb-35ba48df894f",target:"_blank",rel:"noopener noreferrer"}},[e._v("Alerting Framework at Airbnb"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/scaling-airbnbs-payment-platform-43ebfc99b324",target:"_blank",rel:"noopener noreferrer"}},[e._v("Scaling Airbnb Payment Platform"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/measuring-transactional-integrity-in-airbnbs-distributed-payment-ecosystem-a670d6926d22",target:"_blank",rel:"noopener noreferrer"}},[e._v("Measuring Transactional Integrity in Airbnb's Distributed Payment Ecosystem"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/tracking-the-money-scaling-financial-reporting-at-airbnb-6d742b80f040",target:"_blank",rel:"noopener noreferrer"}},[e._v("Tracking the Money - Scaling Financial Reporting at Airbnb"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("Building Services, "),a("a",{attrs:{href:"https://medium.com/airbnb-engineering/building-services-at-airbnb-part-1-c4c1d8fa811b",target:"_blank",rel:"noopener noreferrer"}},[e._v("Part 1"),a("OutboundLink")],1),e._v(", "),a("a",{attrs:{href:"https://medium.com/airbnb-engineering/building-services-at-airbnb-part-2-142be1c5d506",target:"_blank",rel:"noopener noreferrer"}},[e._v("Part 2"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/how-airbnb-manages-to-monitor-customer-issues-at-scale-b883301ca461",target:"_blank",rel:"noopener noreferrer"}},[e._v("How Airbnb manages to monitor customer issues at scale"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/experiment-reporting-framework-4e3fcd29e6c0",target:"_blank",rel:"noopener noreferrer"}},[e._v("Experiment Reporting Framework"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/streamalert-real-time-data-analysis-and-alerting-e8619e3e5043",target:"_blank",rel:"noopener noreferrer"}},[e._v("Streamalert: Real-time Data Analysis and Alerting"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/nebula-as-a-storage-platform-to-build-airbnbs-search-backends-ecc577b05f06",target:"_blank",rel:"noopener noreferrer"}},[e._v("Nebula as a Storage Platform to build Airbnb's Search Backends"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/unlocking-horizontal-scalability-in-our-web-serving-tier-d907449cdbcf",target:"_blank",rel:"noopener noreferrer"}},[e._v("Unlocking Horizontal Scalability in Web Serving Tier"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://medium.com/airbnb-engineering/smartstack-service-discovery-in-the-cloud-4b8a080de619",target:"_blank",rel:"noopener noreferrer"}},[e._v("Smartstack service discovery in the cloud"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://techblog.poppulo.com/microservices-service-discovery-with-smartstack-and-docker/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Service Discovery with Smartstack and Docker"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);r.default=i.exports}}]);